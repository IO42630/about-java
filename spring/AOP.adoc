= Spring AOP
:toc:
:toclevels: 5

==== Idea

* instead of calling util class
** write in util class where it will be applied (~ aspect class)

{empty} +

==== Glossary

[cols="1,4"]
|===
| concern | some cross-cutting concern, e.g. logging
| advice | implementation of concern logic
| join points | places where advice will be injected
| pointcut | specifies join points
|===

==== Typical Concerns

* Logging
* Transaction management
* Security
* Caching
* Error handling
* Performance monitoring
* Business rules

{empty} +

==== Spring

* ðŸŒ± wraps beans in proxy, thus can intercept calls and apply advice.
** this happens at R-time
** methods must be public to be proxied (have a public interface for JDK proxy)


* ðŸŒ± provides 5 _join point_ instructions :
** @Before
** @After : any outcome
** @AfterReturning : after success
** @AfterThrowing : after fail
** @Around : @Before && @After

[source,java]
/* see below for explanation */
@Pointcut("execution(public * *(..))") // pointcut expression
private void anyPublicMethod() {}   // pointcut signature
//
@Before("anyPublicMethod() && args(a,b)")
private void beforeAdvice(String a, String b) { /* advice */ }
// must provide param if args() used

* ðŸŒ± supports 5 _pointcut_ designators
** `execution()`
** `within()`
** `this()`
** `target()`
** `args()`
** `bean`
* `@Pointcut` is meant for the creation reusable _pointcut_ expressions
** empty body
* this vs target
** this checks the proxied object
** target checks the original object
** how are those different -> TODO
* can't use wildcards with `this` , `target`

{empty} +

==== Demo

* see `spring-boot/aop`

ececution() pattern

[source,java]
execution(modifier? ret-type declaring-type? name(param) throws?)
execution(* *(..)) // minimal (no optionals)
execution(String com.olexyn.*(..)) // minimal non-empty
execution(* * * *(..) *) // maximal (all optionals)
execution(public String type?? com.olexyn.*(String) Throwable) // maximal non-empty (TODO)

* see also https://docs.spring.io/spring-framework/docs/2.0.x/reference/aop.html

=== CCC

- Logging and tracing
- Transaction management
- Security
- Caching
- Error handling
- Performance monitoring
- Custom business rules

==== JoinPoint

* optional first parameter of advice method.
* `ProceedingJoinPoint` extends `JoinPoint`
* used to access data.
